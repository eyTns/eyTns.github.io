# Vechu (배추) 설계 문서

주사위 2개를 굴려 점수를 조절하며 정확히 목표 점수를 만드는 로컬 멀티플레이어 게임

## 규칙 요약

- 0점에서 시작, 정확히 목표 점수를 만들면 승리
  - 일반: 50점
  - 곱빼기: 75점
- 턴마다 주사위 2개를 굴리고, 조건에 따라 다시 굴릴 수 있음
- 두 주사위 눈의 곱을 현재 점수에 더하거나 빼야 함
- 누군가 목표 점수 달성 시, 나머지 전원이 달성자 이후 순서부터 한 턴씩 더 진행
- 추가 턴에서 목표 달성한 플레이어도 공동 승리
- 음수, 목표 초과 모두 허용

### 다시 굴리기 — 재귀적

- 2개를 굴렸는데 더블 → 0~2개 다시 굴릴 수 있음
- 2개를 굴렸는데 더블 아님 → 0~1개 다시 굴릴 수 있음
- 1개를 굴렸는데 더블 → 0~1개 다시 굴릴 수 있음
- 1개를 굴렸는데 더블 아님 → 끝

2개를 다시 굴린 결과도 "2개를 굴린 것"이므로 동일한 규칙이 재귀적으로 적용된다.
체인은 무한히 이어질 수 있다.

## 기술 스택

- React 18, CDN + Babel standalone
- 인라인 스타일
- 별도 빌드 도구 없음

## 파일 구조

- `vechu/index.html`
  - 진입점, React/Babel CDN 로드
- `vechu/vechu_constants.jsx`
  - 상수, 스타일 객체, 유틸리티
- `vechu/vechu_game_logic.jsx`
  - 게임 로직: 주사위, 점수, 턴 관리
- `vechu/vechu_interactive.jsx`
  - React 컴포넌트: UI

## 턴 흐름

1. **대기**: "플레이어 N" 이름과 "굴리기" 버튼이 보임
2. **굴리기**: 버튼을 누르면 주사위 2개가 1초 롤링 연출과 함께 결과 표시
3. **다시 굴리기 판단**
   - 더블일 때: "더블!" 표시 + "N개 다시굴리기 가능" 텍스트. 주사위를 탭하여 선택 후 "굴리기" 버튼, 또는 미선택 상태에서 "넘어가기" 버튼
   - 비더블일 때: "1개 다시굴리기 가능" 텍스트. 주사위를 탭하여 선택 후 "굴리기" 버튼, 또는 미선택 상태에서 "넘어가기" 버튼
   - 1개 굴린 비더블일 때: 자동으로 4단계로 넘어감
   - 다시 굴린 결과가 더블이면 3단계를 반복
4. **점수 선택**: "더하기" / "빼기" 버튼 두 개가 표시됨. 하나를 선택한 뒤 "확인" 버튼을 눌러야 반영됨
   - 곱 값을 별도로 표시하지 않음. 플레이어가 직접 암산하는 것이 게임의 핵심
5. **점수 반영**: 확인을 누르면 점수 갱신, 다음 플레이어의 1단계로 이동

## 구현 체크리스트

### 게임 설정 화면

- [x] 플레이어 수 입력, 1~8인
- [x] 플레이어 이름 입력, 기본값 "플레이어 1", "플레이어 2" 등
- [x] 곱빼기 토글 스위치로 게임 모드 선택
  - OFF: 일반 50점
  - ON: 곱빼기 75점
- [x] 게임 시작 버튼

### 주사위 시스템

- [x] 주사위 2개 굴리기 함수
- [x] 주사위 숫자 롤링 연출
  - 0.5초간 40ms 간격으로 숫자가 빠르게 바뀌다가 멈춤
  - 다시 굴리지 않는 주사위는 숫자가 바뀌지 않음
- [x] 더블 판정 함수
- [x] 다시 굴리기 가능 개수 판정
  - 2개 굴린 더블 → 0~2개
  - 2개 굴린 비더블 → 0~1개
  - 1개 굴린 더블 → 0~1개
- [x] "더블!" 텍스트 표시
- [x] "N개 다시굴리기 가능" 텍스트 표시
- [x] 주사위를 탭/클릭하여 다시 굴릴 대상으로 선택/해제
- [x] 최대 선택 개수를 초과하면 기존 선택이 해제되고 새로 탭한 쪽이 선택됨
- [x] 선택된 주사위 시각적 구분
- [x] 주사위 선택 시 "굴리기" 버튼 표시, 미선택 시 "넘어가기" 버튼 표시
- [x] 1개 굴린 비더블에서 자동으로 점수 선택 단계로 전환

### 점수 시스템

- [x] 두 주사위 눈의 곱 계산
- [x] "더하기" / "빼기" 선택 버튼 + "확인" 버튼, 미선택 시 "확인" 비활성화
- [x] 곱 값을 별도로 표시하지 않음, 플레이어가 직접 암산
- [x] 점수 반영 후 상태 업데이트
- [x] 음수 및 목표 초과 허용
- [x] 목표 점수 정확히 달성 감지

### 턴 관리

- [x] 턴 순서를 입력한 순서대로 순환 관리
- [x] 현재 턴 번호 표시
- [x] 현재 턴 플레이어 이름 + "굴리기" 버튼을 함께 표시
- [ ] 목표 달성자 발생 시 안내 메시지 표시
- [x] 추가 턴 진행 중 "마지막 턴" 지속 표시
- [x] 목표 달성자 발생 후 나머지 플레이어 추가 턴 진행
- [x] 추가 턴 순서
  - 달성자 이후부터 한 바퀴
  - 달성자 제외
- [x] 1인 플레이 시 목표 달성하면 "N턴 승리!" 표시

### 게임 종료

- [x] 추가 턴 완료 후 목표 달성자 전원 승리 표시
- [x] 결과 화면
- [x] "처음으로" 버튼, 페이지 새로고침

### 점수판 UI

- [x] 전체 플레이어 점수 목록
- [x] 현재 턴 플레이어 강조
- [x] 목표 달성한 플레이어 표시

### 점수 기록

- [x] 모든 플레이어의 각 턴 점수 변동을 데이터로 보관
  - 턴 번호
  - 플레이어
  - 주사위 결과
  - +/- 선택
  - 변동 전후 점수
- [x] 게임 중 점수 기록을 확인할 수 있는 영역, 하단부에 접기/펼치기 형태, 기본 펼침

### 주사위 UI

- [ ] 주사위 숫자를 48px 이상으로 크게 표시
- [x] 롤링 연출
  - 0.5초간 40ms 간격으로 숫자가 빠르게 바뀌다가 멈춤
- [x] 더블 시 "더블!" 강조 표시
- [x] 다시 굴릴 주사위를 터치/클릭으로 선택 토글
- [x] 선택된 주사위를 테두리, 배경색 등으로 시각적 구분

### 디자인

- [x] 기존 사이트와 통일감 있는 기본 스타일
  - system-ui
  - 슬레이트 계열 색상
- [x] 메인 악센트: 초록 계열, 배추 연상
- [x] 보조 악센트: 따뜻한 노란/주황, 더블 하이라이트에 사용
- [x] 카드형 패널 스타일
- [x] 모바일 세로 배치 우선, 터치하기 쉬운 큰 버튼
- [x] 게임 화면 상단에 "배추" 또는 "배추 곱빼기" 제목 표시

### 인덱스 연결

- [x] 루트 `index.html`에 Vechu 링크 추가

## 보류 사항

- AI 상대
- 순위전 모드
  - 전원이 50점을 찍을 때까지 계속
  - 먼저 찍은 순서대로 순위
- 주사위 이미지 그래픽
  - 숫자 → 도트 이미지 롤링으로 교체
- 리더보드
- 랜덤 턴 순서 섞기
- 게임 도중 포기/재시작
- 게임 저장/불러오기
- 점수 기록 슬라이드 패널
  - 화면 한쪽 꼬다리를 누르면 슥 나오는 UI
  - 종이 필기구 느낌으로 턴별 점수 이력 표시

## 구현 중 결정사항

- 플레이어 수 입력: +/- 버튼 방식
- 롤링 연출: 40ms에서 시작하여 200ms까지 감속하는 이징, 총 1초
- 주사위 크기: 72x72px, 숫자 36px
- 선택된 주사위: 초록 테두리 + 연초록 배경으로 구분
- "더하기" 선택 시 연초록 배경, "빼기" 선택 시 연빨강 배경으로 현재 선택 상태 표시
- 점수판: 플레이어별 카드를 flex wrap으로 배치, 현재 턴 플레이어는 초록 테두리 + 연초록 배경
- 점수 기록: 각 행에 턴 번호, 이름, 주사위 결과, +/- 값, 점수 변동을 한 줄로 표시
- 결과 화면: 트로피 아이콘 + 승리자 표시, 전체 최종 점수, "처음으로" 버튼
- 1인 결과 화면: "N턴 승리!" 메시지
- 턴 번호: 같은 라운드 내에서는 동일한 턴 번호, 첫 번째 플레이어 차례에서 증가
- "마지막 턴" 표시: 노란 배경의 배너로 지속 표시
- 게임 페이즈: SETUP → WAITING → ROLLING → REROLL → SCORE_SELECT → GAME_OVER
